--- mysql-5.0.68/libmysqld/log.cc~	2008-08-13 12:14:31.000000000 +0300
+++ mysql-5.0.68/libmysqld/log.cc	2008-10-27 15:02:24.136737667 +0200
@@ -2543,11 +2543,11 @@
   bool result=0;
   if (opt_error_log)
   {
+    VOID(pthread_mutex_lock(&LOCK_error_log));
+#ifdef __WIN__
     char err_renamed[FN_REFLEN], *end;
     end= strmake(err_renamed,log_error_file,FN_REFLEN-5);
     strmov(end, "-old");
-    VOID(pthread_mutex_lock(&LOCK_error_log));
-#ifdef __WIN__
     char err_temp[FN_REFLEN+5];
     /*
      On Windows is necessary a temporary file for to rename
@@ -2619,7 +2619,6 @@
     {
       freopen(err_temp,"a+",stderr);
       (void) my_delete(err_renamed, MYF(0));
-      my_rename(log_error_file,err_renamed,MYF(0));
       if (freopen(log_error_file,"a+",stdout))
         freopen(log_error_file,"a+",stderr);
       int fd, bytes;
--- mysql-5.0.68/sql/log.cc~	2008-10-27 13:41:07.000000000 +0200
+++ mysql-5.0.68/sql/log.cc	2008-10-27 15:07:07.918167174 +0200
@@ -2592,11 +2592,11 @@
   bool result=0;
   if (opt_error_log)
   {
+    VOID(pthread_mutex_lock(&LOCK_error_log));
+#ifdef __WIN__
     char err_renamed[FN_REFLEN], *end;
     end= strmake(err_renamed,log_error_file,FN_REFLEN-5);
     strmov(end, "-old");
-    VOID(pthread_mutex_lock(&LOCK_error_log));
-#ifdef __WIN__
     char err_temp[FN_REFLEN+5];
     /*
      On Windows is necessary a temporary file for to rename
@@ -2635,7 +2635,6 @@
      result= 1;
 #else
    FILE *reopen;
-   my_rename(log_error_file,err_renamed,MYF(0));
    if (freopen(log_error_file,"a+",stdout))
        reopen= freopen(log_error_file,"a+",stderr);
    else

